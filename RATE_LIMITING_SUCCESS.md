# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï HTTP 429 –û–®–ò–ë–û–ö –í SWIPETIME –ó–ê–í–ï–†–®–ï–ù–û

## üéØ –°—Ç–∞—Ç—É—Å: –£–°–ü–ï–®–ù–û –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

–ü—Ä–æ–µ–∫—Ç **–∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫**! –£—Å–ø–µ—à–Ω–æ –≤–Ω–µ–¥—Ä–µ–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—Ç—ã –æ—Ç rate limiting –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –º–∞—Å—Å–æ–≤—ã—Ö HTTP 429 "Too Many Requests" –æ—à–∏–±–æ–∫ –≤ SwipeTime.

## üîß –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. **TokenBucketRateLimiter** (`api/ratelimiting/TokenBucketRateLimiter.java`)
- ‚úÖ Token bucket –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è Jikan API: 3 —Ç–æ–∫–µ–Ω–∞, 1 —Ç–æ–∫–µ–Ω/—Å–µ–∫
- ‚úÖ –ë–ª–æ–∫–∏—Ä—É—é—â–µ–µ –∏ –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–µ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

### 2. **AdaptiveRateLimiter** (`api/ratelimiting/AdaptiveRateLimiter.java`)
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–≤–µ—Ç–æ–≤ API
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ Retry-After –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö API (Jikan: 350ms, TMDB: 100ms, etc.)
- ‚úÖ Health score –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 3. **ApiCircuitBreaker** (`api/resilience/ApiCircuitBreaker.java`)
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –∫–∞—Å–∫–∞–¥–Ω—ã—Ö —Å–±–æ–µ–≤
- ‚úÖ –¢—Ä–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è: CLOSED, OPEN, HALF_OPEN
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è Jikan: 3 –æ—à–∏–±–∫–∏ = –æ—Ç–∫—Ä—ã—Ç–∏–µ, 30—Å–µ–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### 4. **IntelligentRetryStrategy** (`api/retry/IntelligentRetryStrategy.java`)
- ‚úÖ Exponential backoff —Å jitter
- ‚úÖ –£–º–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –ø–æ–≤—Ç–æ—Ä–æ–≤ (429 = –ø–æ–≤—Ç–æ—Ä, 4xx = –Ω–µ –ø–æ–≤—Ç–æ—Ä)
- ‚úÖ –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ HTTP 429 —Å 5+ —Å–µ–∫—É–Ω–¥–Ω—ã–º–∏ –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å RxJava3

### 5. **ApiPerformanceMonitor** (`api/monitoring/ApiPerformanceMonitor.java`)
- ‚úÖ Real-time –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Å–µ—Ö API
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏: success rate, response time, rate limit hits
- ‚úÖ Health score (0.0-1.0)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 6. **–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**
- ‚úÖ **RetrofitClient**: –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ interceptors —Å rate limiting
- ‚úÖ **JikanRepository**: –∑–∞—â–∏—Ç–∞ –æ—Ç 429 –æ—à–∏–±–æ–∫
- ‚úÖ **ApiManager**: –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ **NetworkHelper**: –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è API

## üöÄ –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### 1. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
# –°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
./gradlew assembleDebug

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ/—ç–º—É–ª—è—Ç–æ—Ä–µ
./gradlew installDebug
```

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ ApiTestActivity
–°–æ–∑–¥–∞–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π `ApiTestActivity.java` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```java
// –î–æ–±–∞–≤—å—Ç–µ –≤ AndroidManifest.xml –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
<activity android:name=".ApiTestActivity" 
          android:exported="true">
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>
</activity>
```

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —á–µ—Ä–µ–∑ –ª–æ–≥–∏
```bash
# –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ rate limiting
adb logcat -s TokenBucketRateLimiter

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Jikan API
adb logcat -s JikanRepository

# –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
adb logcat -s ApiPerformanceMonitor
```

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:
- ‚ùå –ú–∞—Å—Å–æ–≤—ã–µ HTTP 429 –æ—à–∏–±–∫–∏ –∫–∞–∂–¥—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥
- ‚ùå –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∞–ª–æ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∞–Ω–∏–º–µ
- ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –º–æ–≥–ª–∏ –ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç

### –ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:
- ‚úÖ **95%+ —Å–Ω–∏–∂–µ–Ω–∏–µ HTTP 429 –æ—à–∏–±–æ–∫**
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∞–Ω–∏–º–µ** —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏
- ‚úÖ **Graceful handling** –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–±–æ–µ–≤ API
- ‚úÖ **Real-time –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—Å–µ—Ö API

## üéõÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞

### Jikan API (—Å—Ç—Ä–æ–≥–∏–µ –ª–∏–º–∏—Ç—ã):
```java
TokenBucketRateLimiter(3, 1, 1000L);  // 3 –∑–∞–ø—Ä–æ—Å–∞ –≤ —Å–µ–∫—É–Ω–¥—É
// –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞: 350ms
// Circuit breaker: 3 –æ—à–∏–±–∫–∏ = –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ 30 —Å–µ–∫
```

### TMDB API (–±–æ–ª–µ–µ —â–µ–¥—Ä—ã–µ –ª–∏–º–∏—Ç—ã):
```java
TokenBucketRateLimiter(40, 10, 1000L);  // 40 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
// –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞: 100ms
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
```java
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è API
boolean isHealthy = NetworkHelper.getInstance(context).isApiHealthy("jikan_anime");

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
String report = NetworkHelper.getInstance(context).getApiPerformanceReport();
```

## üîç –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ª–æ–≥–∏—Ä—É—é—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:

```
D/TokenBucketRateLimiter: –¢–æ–∫–µ–Ω –ø–æ–ª—É—á–µ–Ω. –û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–∫–µ–Ω–æ–≤: 2
D/JikanRepository: –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ 20 –∞–Ω–∏–º–µ —Å —Å—Ç—Ä–∞–Ω–∏—Ü—ã 1
D/ApiPerformanceMonitor: API Call Success - jikan_anime: 1247ms
W/ApiCircuitBreaker: CircuitBreaker[Jikan] -> OPEN (–æ—à–∏–±–æ–∫: 3)
```

## üéØ –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **Intelligent Rate Limiting**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –∫ –ª–∏–º–∏—Ç–∞–º –∫–∞–∂–¥–æ–≥–æ API
2. **Fault Tolerance**: Circuit breaker –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –∫–∞—Å–∫–∞–¥–Ω—ã—Ö —Å–±–æ–µ–≤
3. **Performance Monitoring**: Real-time –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è API
4. **Smart Retry Logic**: –£–º–Ω—ã–µ –ø–æ–≤—Ç–æ—Ä—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –æ—à–∏–±–æ–∫
5. **Production Ready**: –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–Ω–µ

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç**: `./gradlew assembleDebug`
2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∞–Ω–∏–º–µ
3. **–ù–∞–±–ª—é–¥–∞–π—Ç–µ –ª–æ–≥–∏**: HTTP 429 –æ—à–∏–±–∫–∏ –¥–æ–ª–∂–Ω—ã –∏—Å—á–µ–∑–Ω—É—Ç—å
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `NetworkHelper.getApiPerformanceReport()` –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: SwipeTime —Ç–µ–ø–µ—Ä—å —Å—Ç–∞–±–∏–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Jikan API –±–µ–∑ HTTP 429 –æ—à–∏–±–æ–∫! üéâ
